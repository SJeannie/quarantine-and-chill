{"version":3,"sources":["../../../src/commands/new/newWebProject.js"],"names":["newWebProject","name","progress","printOut","update","productionDependencies","join","developmentDependencies","packagePath","path","process","cwd","statePath","config","require","engines","version","slice","scripts","fs","writeFile","JSON","stringify","gitignorePath","gitignoreContent","readFile","STATE_STORAGE_PATH","assets","__dirname","srcPath","rmdir","mkdir","Promise","all","map","folder","source","destination","copy","stop"],"mappings":"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","sourcesContent":["import { fs, copy, prompt, exec, path, print, printProgressBar, STATE_STORAGE_PATH, Repo } from '../../utils'\r\nimport { productionDependencies, developmentDependencies } from './dependencies'\r\n\r\nexport default async function newWebProject(name) {\r\n\r\n    print('Starting...')\r\n    let progress = printProgressBar()\r\n    await exec(`npx create-react-app \"${name}\"`, {\r\n        printOut: true\r\n    })\r\n\r\n    progress.update(50)\r\n    await exec(`cd \"${name}\" && npm install ${productionDependencies.join(' ')}`, {\r\n        printOut: true\r\n    })\r\n    await exec(`cd \"${name}\" && npm install ${developmentDependencies.join(' ')} --save-dev`, {\r\n        printOut: true\r\n    })\r\n    const packagePath = path.join(process.cwd(), name, 'package.json')\r\n    const statePath = path.join(process.cwd(), name, '.triframe')\r\n\r\n    const config = require(packagePath)\r\n    config.engines = {\r\n        \"node\": process.version.slice(1)\r\n    }\r\n    config.scripts = {\r\n        \"start\": \"triframe start\"\r\n    }\r\n    await fs.writeFile(packagePath, JSON.stringify(config, null, 2))\r\n    await fs.writeFile(statePath, `{\"name\":\"${name}\",\"platform\":\"web\"}`)\r\n\r\n    const gitignorePath = path.join(process.cwd(), name, '.gitignore')\r\n    const gitignoreContent = await fs.readFile(gitignorePath)\r\n    await fs.writeFile(gitignorePath, `${gitignoreContent}\r\ndist\r\nbuild\r\n${STATE_STORAGE_PATH}\r\n.storage\r\n.env\r\n`)\r\n\r\n\r\n    const assets = path.join(__dirname, '..', '..', '..', '__assets__')\r\n\r\n    progress.update(75)\r\n\r\n    const srcPath = path.join(process.cwd(), name, \"src\")\r\n    await fs.rmdir(srcPath)\r\n\r\n    await fs.mkdir(srcPath)\r\n\r\n    await Promise.all(['App.js', 'Api.js', 'views', 'models', 'index.js'].map(async folder => {\r\n        let source = path.join(assets, folder)\r\n        let destination = path.join(process.cwd(), name, \"src\", folder)\r\n        await fs.copy(source, destination)\r\n    }))\r\n\r\n    await Promise.all(['index.html'].map(async folder => {\r\n        let source = path.join(assets, folder)\r\n        let destination = path.join(process.cwd(), name, \"public\", folder)\r\n        await fs.copy(source, destination)\r\n    }))\r\n\r\n    await Promise.all(['.env'].map(async folder => {\r\n        let source = path.join(assets, folder)\r\n        let destination = path.join(process.cwd(), name, folder)\r\n        await fs.copy(source, destination)\r\n    }))\r\n    \r\n    progress.update(100)\r\n    progress.stop()\r\n    print(`Project setup complete! Next Steps:\r\n        1. Open \"${name}\"\r\n        2. Configure your Postgres connection in the .env file\r\n        3. Run 'npm start'\r\n    `)\r\n}"],"file":"newWebProject.js"}