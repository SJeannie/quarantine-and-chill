{"version":3,"sources":["../../../src/adapters/Heroku/index.js"],"names":["Heroku","requiresRelease","getOptions","dependencyCheck","findOrCreateRemote","fs","writeFile","path","join","process","cwd","err","Error","deploy","branch","options","repo","Repo","stuffForTesting","push","printOut","console","log","repos","getRemotes","includes"],"mappings":";;;;;;;AAAA;;AAEO,MAAMA,MAAM,WAANA,MAAM,GAAG;AAElBC,EAAAA,eAAe,EAAE,KAFC;AAIlBC,EAAAA,UAAU,EAAE,kBAAiB;AAEzB,UAAM,KAAKC,eAAL,EAAN;AAEA,UAAM,KAAKC,kBAAL,EAAN;AAEA,UAAMC,UAAGC,SAAH,CAAaC,YAAKC,IAAL,CAAUC,OAAO,CAACC,GAAR,EAAV,EAAyB,UAAzB,CAAb,EAAoD,oBAApD,CAAN;AAEA,WAAO,EAAP;AACH,GAbiB;AAelBP,EAAAA,eAAe,EAAE,YAAY;AACzB,QAAI;AACA,YAAM,iBAAK,kBAAL,CAAN;AACH,KAFD,CAEE,OAAMQ,GAAN,EAAU;AACR,YAAMC,KAAK,CAAE,mKAAF,CAAX;AACH;;AACD,QAAI;AACA,YAAM,iBAAK,mBAAL,CAAN;AACH,KAFD,CAEE,OAAMD,GAAN,EAAW;AACT,YAAMC,KAAK,CAAE,8DAAF,CAAX;AACH;AACJ,GA1BiB;AA4BlBC,EAAAA,MAAM,EAAE,gBAAeC,MAAf,EAAuBC,OAAvB,EAA+B;AACnC,QAAIC,IAAI,GAAG,IAAIC,WAAJ,EAAX;AAEA,sBAAM,cAAN;AACA,QAAIC,eAAe,GAAG,MAAMF,IAAI,CAACG,IAAL,CAAW,UAASL,MAAO,SAA3B,EAAqC;AAC7DM,MAAAA,QAAQ,EAAE;AADmD,KAArC,CAA5B;AAGAC,IAAAA,OAAO,CAACC,GAAR,CAAYJ,eAAZ;AACH,GApCiB;;AAsClB,QAAMd,kBAAN,GAA0B;AACtB,QAAIY,IAAI,GAAG,IAAIC,WAAJ,EAAX;AAEA,QAAIM,KAAK,GAAG,MAAMP,IAAI,CAACQ,UAAL,EAAlB;;AAEA,QAAG,CAACD,KAAK,CAACE,QAAN,CAAe,QAAf,CAAJ,EAA6B;AACzB,YAAM,iBAAK,eAAL,CAAN;AACA,YAAM,iBAAK,kDAAL,CAAN;AACA,YAAM,iBAAK,8CAAL,CAAN;AACH;AACJ;;AAhDiB,CAAf","sourcesContent":["import { Repo, print, exec, fs, path } from \"../../utils\"\r\n\r\nexport const Heroku = {\r\n\r\n    requiresRelease: false,\r\n\r\n    getOptions: async function() {\r\n\r\n        await this.dependencyCheck()\r\n\r\n        await this.findOrCreateRemote()\r\n\r\n        await fs.writeFile(path.join(process.cwd(), 'Procfile'), `web: node ./Api.js`)\r\n\r\n        return {}\r\n    },\r\n\r\n    dependencyCheck: async () => {\r\n        try {\r\n            await exec('heroku --version')\r\n        } catch(err){\r\n            throw Error(`heroku cli is required to use this utility. Install it here: https://devcenter.heroku.com/articles/heroku-cli#download-and-install, then login run 'heroku login'`)\r\n        }\r\n        try {\r\n            await exec('heroku auth:token')\r\n        } catch(err) {\r\n            throw Error(`You are not logged into to heroku. Please run 'heroku login'`)\r\n        }\r\n    },\r\n\r\n    deploy: async function(branch, options){\r\n        let repo = new Repo\r\n\r\n        print('Deploying...')\r\n        let stuffForTesting = await repo.push(`heroku ${branch}:master`, {\r\n            printOut: true\r\n        })\r\n        console.log(stuffForTesting)\r\n    },\r\n\r\n    async findOrCreateRemote(){\r\n        let repo = new Repo\r\n\r\n        let repos = await repo.getRemotes()\r\n\r\n        if(!repos.includes('heroku')){\r\n            await exec('heroku create')\r\n            await exec('heroku addons:create heroku-postgresql:hobby-dev')\r\n            await exec('heroku config:set NPM_CONFIG_PRODUCTION=true')\r\n        }\r\n    }\r\n\r\n}"],"file":"index.js"}